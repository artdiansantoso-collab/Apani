<script>
  async function send() {
    const input = document.getElementById("input");
    const chat = document.getElementById("chat");
    const text = input.value.trim();
    if (!text) return;

    input.value = "";
    chat.innerHTML += "<p><b>Kamu:</b> " + text + "</p>";

    const res = await fetch("/.netlify/functions/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });

    const data = await res.json().catch(() => ({}));

    if (!res.ok || data.error) {
      chat.innerHTML += "<p><b>Error:</b> " + (data.error || ("HTTP " + res.status)) + "</p>";
      return;
    }

    chat.innerHTML += "<p><b>AI:</b> " + data.reply + "</p>";
  }
</script>
